> (= foo (new-namespace (new-namespace (new-namespace)) (new-namespace)))
#<namespace (len 4)>

> foo!bar
nil

> (= foo!bar 10)
10

> foo!bar
10

> foo!qux
nil


> (eval-w/ (new-namespace) foo)
error: undefined variable: foo


> (= bar (new-namespace arc3-namespace))

> (eval-w/ bar foo)
#<namespace (len 4)>

> (eval-w/ bar (= foo 10))
10

> (eval-w/ bar foo)
10

> foo
#<namespace (len 4)>


;> (w/namespace bar (eval '(= foo 10)))
10

;> (w/namespace bar foo)
10

;> foo
#(tagged namespace {#<namespace:0> #<namespace:0> #<namespace:0> #<namespace:0>})


> (= foo (new-namespace namespace))
#<namespace (len 2)>

> (= bar (new-namespace foo))
#<namespace (len 3)>

> (eval-w/ foo
    (def foo (x)
      (bar x))
    (def bar (x)
      x))
#<fn>

> (eval-w/ bar
    (foo 50))
50

> (eval-w/ bar
    (def bar (x)
      10)
    (foo 50))
50

> (eval-w/ foo
    (dynamic bar bar))
#<fn:bar>

> (eval-w/ bar
    (foo 50))
10

> (eval-w/ foo
    (foo 50))
50


;=============================================================================
;  Dynamic variables
;=============================================================================

> (dynamic foo 5)
5

> foo
5

> (= foo 10)
10

> foo
10


;=============================================================================
;  Implicit namespace creation
;=============================================================================

> (def nou ())
#<fn:nou>

> namespace
#<namespace:0>

> (def nou ())
#<fn:nou>

> namespace
#<namespace (len 2)>


;=============================================================================
;  Namespace reversal
;=============================================================================

> (= arc    (new-namespace arc3-namespace))
#<namespace (len 2)>

> (= arubic (new-namespace arc))
#<namespace (len 3)>


> (eval-w/ arc
    (def qux (x)
      10)
    (def nou (x)
      29))
#<fn:nou>

> (eval-w/ arubic
    (def qux (x)
      x)
    (def corge (x)
      (+ (qux x) (nou x))))
#<fn:corge>


> (eval-w/ arc
    (qux 50))
10

> (eval-w/ arubic
    (qux 50))
50

> (eval-w/ arc
    (corge 50))
error: undefined variable: corge

> (eval-w/ arubic
    (corge 50))
79


> (zap namespace-fn arubic rev)
#<namespace (len 3)>


> (eval-w/ arc
    (qux 50))
10

> (eval-w/ arubic
    (qux 50))
10

> (eval-w/ arc
    (corge 50))
error: undefined variable: corge

> (eval-w/ arubic
    (corge 50))
79
