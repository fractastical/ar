#! /usr/bin/env arc

(load "lib/tester.arc")
(load "lib/parse-script-args.arc")

(= verbose nil)

(parse-script-args
  ("-v" "--verbose" (= verbose t)))

#|(each x script-args
  (test-file x))|#

(map test-file script-args)

(def test-files-sudo args
  (system:string "sudo ./arc run-tests" (map [+ " \"tests/" _ "\""] args)))

(unless script-args
  (test-files-sudo "arc (root)"
                   "io.arc (root)") ; must be last

  (w/curdir "tests"
    ;(system "set -e -v")
    (system "mzscheme ac-test.ss")

    (test-files "apply"
                "arc"
                "assign"
                "coerce"
                "del"
                "fn"
                "if"
                "import"
                "io.arc"
                "object.arc"
                "Paths"
                "quasiquote"
                "quote"
                ;"re" ; our re support is too broken right now, enable later
                "Sets"
                "Slicing"
                "strings.arc"
                "(coerce foo 'fn)")))
